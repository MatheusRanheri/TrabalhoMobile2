import { View, StyleSheet, Text, Image } from "react-native";
import { useState, useEffect, useRef } from "react";
import * as Location from "expo-location";

export default function Sucesso() {


    const [temPermissao, setTemPermissao] = useState(false);
    const [endereco, setEndereco] = useState(null);

    useEffect(() => {
        (async () => {
            let { status } = await Location.requestForegroundPermissionsAsync();
            if (status !== 'granted') {
                console.log('Permissão negada');
                return;
            }
            setTemPermissao(true);

            let location = await Location.getCurrentPositionAsync({});
            let reverse = await Location.reverseGeocodeAsync({
                latitude: location.coords.latitude,
                longitude: location.coords.longitude,
            });

            if (reverse.length > 0) {
                setEndereco(reverse[0]);
            }
        })();
    }, []);



    return (
        <View style={styles.container}>
            <Image
                style={styles.imagem}
                source={require("../../assets/gon.webp")}
            />

            <Text style={styles.texto}>BAITAAAA</Text>

            {temPermissao && endereco && (
                <Text style={styles.texto}>
                    País: {endereco.country || "Não encontrada"}
                    {"\n"}
                    Estado: {endereco.region || "Não encontrada"}
                    {"\n"}
                    Cidade: {endereco.city || endereco.subregion || "Não encontrada"}
                    {"\n"}
                    Rua: {endereco.street || "Não encontrada"}
                    
                    
                    
                </Text>
            )}
        </View>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: '#ebf0f7',
        alignItems: 'center',
        justifyContent: 'center',
        paddingTop: 20,
    },
    texto: {
        fontSize: 18,
        alignSelf: 'center',
    },
    imagem: {
        alignSelf: 'center',
        width: 300,
        height: 300
    }

});
